inner_join(feature_set,by=c("Feature"="ID"))
View(phonology_K4_features_names)
View(phonology_K4_feature_contributions)
names(phonology_K4_feature_contributions) <- c("Feature", "PercentMissing", "ProportionPresent", "Mongolo-Koreanic", "Tungusic", "Japonic", "Turkic")
View(phonology_K4_feature_contributions)
names(morphology_K4_feature_contributions) <- c("Feature", "PercentMissing", "ProportionPresent", "Japono-Koreanic", "Turkic", "Tungusic", "Mongolic")
names(syntax_K4_feature_contributions) <- c("Feature", "PercentMissing", "ProportionPresent", "Tungusic", "Japono-Koreanic", "Turkic", "Mongolic")
View(syntax_K4_feature_contributions)
phonology_K4_feature_contributions = read.csv("data/feature_contributions/outfile_phonology_structure_K4_run41_f",sep="\t")
morphology_K4_feature_contributions = read.csv("data/feature_contributions/outfile_morphology_structure_K4_run6_f",sep="\t")
syntax_K4_feature_contributions = read.csv("data/feature_contributions/outfile_syntax_structure_K4_run36_f",sep="\t")
names(phonology_K4_feature_contributions) <- c("Feature", "PercentMissing", "ProportionPresent", "Mongolo-Koreanic", "Tungusic", "Japonic", "Turkic")
names(morphology_K4_feature_contributions) <- c("Feature", "PercentMissing", "ProportionPresent", "Japono-Koreanic", "Turkic", "Tungusic", "Mongolic")
names(syntax_K4_feature_contributions) <- c("Feature", "PercentMissing", "ProportionPresent", "Tungusic", "Japono-Koreanic", "Turkic", "Mongolic")
View(morphology_K4_feature_contributions)
phonology_K4_features_names <- phonology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID"))
word_K4_features_names <- word_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID"))
clause_K4_features_names <- clause_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID"))
View(morphology_K4_feature_contributions)
phonology_K4_features_gather <- phonology_K4_features_names%>%
gather(variable, value, -PercentMissing, -ProportionPresent)
View(phonology_K4_features_gather)
phonology_K4_features_gather <- phonology_K4_features_names%>%
gather(variable, value, -PercentMissing, -ProportionPresent, -Feature)
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c('J','MK','Tk','Tg'),values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
phonology_K4_features_selected_1_melt_plt
phonology_K4_features_gather_plot
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c('J','MK','Tk','Tg'),values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
phonology_K4_features_gather_plot
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank())
phonology_K4_features_gather_plot
View(phonology_K4_features_gather_plot)
View(phonology_K4_features_names)
phonology_K4_features_names <- phonology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID")) %>%
select(-Feature, -PercentMissing, -ProportionPresent, -Feature.y)
phonology_K4_features_gather <- phonology_K4_features_names %>%
gather(variable, value, -PercentMissing, -ProportionPresent, -Feature)
phonology_K4_features_gather <- phonology_K4_features_names %>%
gather(variable, value)
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c('J','MK','Tk','Tg'),values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
phonology_K4_features_gather_plot
phonology_K4_features_gather <- phonology_K4_features_names %>%
gather(variable, value)
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c('J','MK','Tk','Tg'),values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
phonology_K4_features_gather_plot
View(phonology_K4_features_gather)
phonology_K4_features_gather <- phonology_K4_features_names %>%
gather(variable, value, -Feature_short)
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c('J','MK','Tk','Tg'),values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
phonology_K4_features_gather_plot
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
phonology_K4_features_gather_plot
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
morphology_K4_features_names <- morphology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID"))
syntax_K4_features_names <- syntax_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID"))
morphology_K4_features_gather <- morphology_K4_features_names %>%
gather(variable, value, -Feature_short)
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#8DA0CB','#E78AC3','#FC8D62','#66C2A5'))
morphology_K4_features_selected_1_melt_plt
morphology_K4_features_gather_plot
View(phonology_K4_features_names)
morphology_K4_features_gather <- morphology_K4_features_names %>%
gather(variable, value, -Feature_short)
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#8DA0CB','#E78AC3','#FC8D62','#66C2A5'))
morphology_K4_features_gather_plot
View(phonology_K4_features_gather)
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank())
morphology_K4_features_gather_plot
morphology_K4_features_names <- morphology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID")) %>%
select(-Feature, -PercentMissing, -ProportionPresent, -Feature.y)
syntax_K4_features_names <- syntax_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID")) %>%
select(-Feature, -PercentMissing, -ProportionPresent, -Feature.y)
morphology_K4_features_gather <- morphology_K4_features_names %>%
gather(variable, value, -Feature_short)
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#8DA0CB','#E78AC3','#FC8D62','#66C2A5'))
morphology_K4_features_gather_plot
syntax_K4_features_gather <- syntax_K4_features_names %>%
gather(variable, value, -Feature_short)
syntax_K4_features_gather_plot <- ggplot(v, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Tungusic", "Japono-Koreanic", "Turkic", "Mongolic",),values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
syntax_K4_features_gather_plot
syntax_K4_features_gather <- syntax_K4_features_names %>%
gather(variable, value, -Feature_short)
View(syntax_K4_features_gather)
syntax_K4_features_gather_plot <- ggplot(v, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Tungusic", "Japono-Koreanic", "Turkic", "Mongolic",),values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
syntax_K4_features_gather_plot
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Tungusic", "Japono-Koreanic", "Turkic", "Mongolic",),values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
syntax_K4_features_gather_plot
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Tungusic", "Japono-Koreanic", "Turkic", "Mongolic"),values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
syntax_K4_features_gather_plot
View(morphology_K4_feature_contributions)
ggsave("phonology-K4-features-all.pdf", phonology_K4_features_selected_1_melt_plt,height=5,width=7)
ggsave("plots/phonology-K4-features-all.pdf", phonology_K4_features_gather_plot,height=5,width=7)
ggsave("plots/morphology-K4_feature-all.pdf", morphology_K4_features_gather_plot,height=10,width=7)
ggsave("plots/syntax-K4-features-all.pdf", syntax_K4_features_gather_plot,height=10,width=7)
morphology_K4_features_gather_plot
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#E78AC3','#8DA0CB','#FC8D62','#66C2A5'))
morphology_K4_features_gather_plot
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#E78AC3','#66C2A5','#FC8D62','#8DA0CB'))
morphology_K4_features_gather_plot
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#E78AC3','#FC8D62','#66C2A5','#8DA0CB'))
morphology_K4_features_gather_plot
syntax_K4_features_gather_plot
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Tungusic", "Japono-Koreanic", "Turkic", "Mongolic"),values=c('#8DA0CB','#E78AC3','#FC8D62','#66C2A5'))
syntax_K4_features_gather_plot
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Tungusic", "Japono-Koreanic", "Turkic", "Mongolic"),values=c('#66C2A5','#E78AC3','#FC8D62','#8DA0CB'))
syntax_K4_features_gather_plot
ggsave("plots/syntax-K4-features-all.pdf", syntax_K4_features_gather_plot,height=10,width=7)
ggsave("plots/morphology-K4_feature-all.pdf", morphology_K4_features_gather_plot,height=10,width=7)
View(phonology_K4_feature_contributions)
View(morphology_K4_feature_contributions)
phonology_K4_features_names <- phonology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID")) %>%
select(-Feature, -PercentMissing, -ProportionPresent, -Feature.y) %>%
filter(PropotionPresent < 0.820)
phonology_K4_features_names <- phonology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID")) %>%
select(-Feature, -PercentMissing, -ProportionPresent, -Feature.y) %>%
filter(ProportionPresent < 0.820)
phonology_K4_features_names <- phonology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID")) %>%
select(-Feature, -PercentMissing, -ProportionPresent, -Feature.y) %>%
filter(ProportionPresent < 0.820)
phonology_K4_features_names <- phonology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID")) %>%
filter(ProportionPresent < 0.820) %>%
select(-Feature, -PercentMissing, -ProportionPresent, -Feature.y)
View(morphology_K4_features_names)
morphology_K4_features_gather <- morphology_K4_features_names %>%
gather(variable, value, -Feature_short)
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#E78AC3','#FC8D62','#66C2A5','#8DA0CB'))
morphology_K4_features_gather_plot
phonology_K4_features_names <- phonology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID")) %>%
filter(ProportionPresent < 0.820) %>%
select(-Feature, -PercentMissing, -ProportionPresent, -Feature.y)
morphology_K4_features_names <- morphology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID")) %>%
filter(ProportionPresent < 0.820) %>%
select(-Feature, -PercentMissing, -ProportionPresent, -Feature.y)
morphology_K4_features_gather <- morphology_K4_features_names %>%
gather(variable, value, -Feature_short)
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#E78AC3','#FC8D62','#66C2A5','#8DA0CB'))
morphology_K4_features_gather_plot
morphology_K4_features_names <- morphology_K4_feature_contributions %>%
inner_join(feature_set,by=c("Feature"="ID")) %>%
select(-Feature, -PercentMissing, -ProportionPresent, -Feature.y)
morphology_K4_features_gather <- morphology_K4_features_names %>%
gather(variable, value, -Feature_short)
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Feature presence", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#E78AC3','#FC8D62','#66C2A5','#8DA0CB'))
morphology_K4_features_gather_plot
View(phonology_K4_features_gather)
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology", x = "Proportion in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
library(patchwork)
ggsave("plots/features.pdf", (phonology_K4_features_gather_plot | morphology_K4_features_gather_plot | syntax_K4_features_gather_plot) ,height=10,width=10)
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology", x = "Feature presence frequency in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Morphology", x = "Feature presence frequency in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#E78AC3','#FC8D62','#66C2A5','#8DA0CB'))
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Syntax", x = "Feature presence frequency in each ancestry",y=element_blank()) +
scale_fill_manual(name = "Ancestry:",labels = c("Tungusic", "Japono-Koreanic", "Turkic", "Mongolic"),values=c('#66C2A5','#E78AC3','#FC8D62','#8DA0CB'))
ggsave("plots/features.pdf", (phonology_K4_features_gather_plot | morphology_K4_features_gather_plot | syntax_K4_features_gather_plot) ,height=10,width=10)
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology", x = "Feature presence frequency in each ancestry",y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
ggsave("plots/phonology-K4-features.pdf", phonology_K4_features_gather_plot,height=5,width=7)
# Morphology: feature contributions
morphology_K4_features_gather <- morphology_K4_features_names %>%
gather(variable, value, -Feature_short)
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Morphology", x = "Feature presence frequency in each ancestry",y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",labels = c("Japono-Koreanic", "Turkic", "Tungusic", "Mongolic"),values=c('#E78AC3','#FC8D62','#66C2A5','#8DA0CB'))
morphology_K4_features_gather_plot
ggsave("plots/morphology-K4_feature.pdf", morphology_K4_features_gather_plot,height=10,width=7)
# Syntax: feature contributions
syntax_K4_features_gather <- syntax_K4_features_names %>%
gather(variable, value, -Feature_short)
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Syntax", x = "Feature presence frequency in each ancestry",y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",labels = c("Tungusic", "Japono-Koreanic", "Turkic", "Mongolic"),values=c('#66C2A5','#E78AC3','#FC8D62','#8DA0CB'))
syntax_K4_features_gather_plot
ggsave("plots/syntax-K4-features.pdf", syntax_K4_features_gather_plot,height=10,width=7)
ggsave("plots/features.pdf", (phonology_K4_features_gather_plot | morphology_K4_features_gather_plot | syntax_K4_features_gather_plot) ,height=10,width=10)
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology",  labels = c("MK", "Tg", "J", "Tk"), x = "Feature presence frequency in each ancestry", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Morphology", x = "Feature presence frequency in each ancestry",y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",labels = c("JK", "Tk", "Tg", "M"),values=c('#E78AC3','#FC8D62','#66C2A5','#8DA0CB'))
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology",  labels = c("MK", "Tg", "J", "Tk"), x = "Feature presence frequency in each ancestry", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
morphology_K4_features_gather <- morphology_K4_features_names %>%
gather(variable, value, -Feature_short)
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Morphology", x = "Feature presence frequency in each ancestry",y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",labels = c("JK", "Tk", "Tg", "M"),values=c('#E78AC3','#FC8D62','#66C2A5','#8DA0CB'))
morphology_K4_features_gather_plot
syntax_K4_features_gather <- syntax_K4_features_names %>%
gather(variable, value, -Feature_short)
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Syntax", x = "Feature presence frequency in each ancestry",y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",labels = c("Tg", "JK", "Tk", "M"),values=c('#66C2A5','#E78AC3','#FC8D62','#8DA0CB'))
syntax_K4_features_gather_plot
ggsave("plots/features.pdf", (phonology_K4_features_gather_plot | morphology_K4_features_gather_plot | syntax_K4_features_gather_plot) ,height=10,width=10)
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology",  labels = c("MK", "Tg", "J", "Tk"), x = "Feature presence frequency in each ancestry", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology",  x = "Feature presence frequency in each ancestry", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", labels = c("MK", "Tg", "J", "Tk"), values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology",  x = "Feature presence frequency", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", labels = c("MK", "Tg", "J", "Tk"), values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
morphology_K4_features_gather <- morphology_K4_features_names %>%
gather(variable, value, -Feature_short)
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Morphology", x = "Feature presence frequency",y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",labels = c("JK", "Tk", "Tg", "M"),values=c('#E78AC3','#FC8D62','#66C2A5','#8DA0CB'))
morphology_K4_features_gather_plot
syntax_K4_features_gather <- syntax_K4_features_names %>%
gather(variable, value, -Feature_short)
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Syntax", x = "Feature presence frequency", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",labels = c("Tg", "JK", "Tk", "M"),values=c('#66C2A5','#E78AC3','#FC8D62','#8DA0CB'))
syntax_K4_features_gather_plot
ggsave("plots/features.pdf", (phonology_K4_features_gather_plot | morphology_K4_features_gather_plot | syntax_K4_features_gather_plot) ,height=10,width=10)
ggsave("plots/features.pdf", (phonology_K4_features_gather_plot | morphology_K4_features_gather_plot | syntax_K4_features_gather_plot) ,height=10,width=15)
phonology_K4_features_gather_plot
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology",  x = "Feature presence frequency", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", labels = c("MK", "Tg", "J", "Tk"), values=c('#8DA0CB','#E78AC3','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Morphology", x = "Feature presence frequency",y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", values=c('#E78AC3','#FC8D62','#66C2A5','#8DA0CB'))
morphology_K4_features_gather_plot
morphology_K4_features_gather_plot <- ggplot(morphology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Morphology", x = "Feature presence frequency",y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", labels = c("JK", "M", "Tg", "Tk"), values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
morphology_K4_features_gather_plot
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology",  x = "Feature presence frequency", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
phonology_K4_features_gather_plot <- ggplot(phonology_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Phonology",  x = "Feature presence frequency", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", labels = c("J", "MK", "Tg", "Tk"), values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
phonology_K4_features_gather_plot
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Syntax", x = "Feature presence frequency", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:",values=c('#66C2A5','#E78AC3','#FC8D62','#8DA0CB'))
syntax_K4_features_gather_plot
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Syntax", x = "Feature presence frequency", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", labels = c("JK", "M", "Tg", "Tk"), values=c('#66C2A5','#8DA0CB','#FC8D62','#E78AC3'))
syntax_K4_features_gather_plot
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Syntax", x = "Feature presence frequency", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", labels = c("JK", "M", "Tg", "Tk"), values=c('#FC8D62','#8DA0CB','#66C2A5','#E78AC3'))
syntax_K4_features_gather_plot
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Syntax", x = "Feature presence frequency", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", labels = c("JK", "M", "Tg", "Tk"), values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
syntax_K4_features_gather_plot
ggsave("plots/features.pdf", (phonology_K4_features_gather_plot | morphology_K4_features_gather_plot | syntax_K4_features_gather_plot) ,height=10,width=1)
syntax_K4_features_gather_plot <- ggplot(syntax_K4_features_gather, aes(x=value,y=reorder(Feature_short,value),fill=variable)) +
geom_col() +
labs(title = "Syntax", x = "Feature presence frequency", y=element_blank()) +
theme(legend.position="bottom") +
scale_fill_manual(name = "Ancestry:", labels = c("JK", "M", "Tg", "Tk"), values=c('#E78AC3','#8DA0CB','#66C2A5','#FC8D62'))
syntax_K4_features_gather_plot
ggsave("plots/features.pdf", (phonology_K4_features_gather_plot | morphology_K4_features_gather_plot | syntax_K4_features_gather_plot) ,height=10,width=1)
ggsave("plots/features.pdf", (phonology_K4_features_gather_plot | morphology_K4_features_gather_plot | syntax_K4_features_gather_plot) ,height=10,width=15)
ggsave("plots/features.pdf", (phonology_K4_features_gather_plot | morphology_K4_features_gather_plot | syntax_K4_features_gather_plot) ,height=15,width=15)
morphology_K4 <- read.csv("data/outfiles_cleaned/outfile_morphology_structure_K4_run6_f", sep="\t")
syntax_K4 <- read.csv("data/outfiles_cleaned/outfile_syntax_structure_K4_run36_f", sep="\t")
View(morphology_K4)
# load the file with language names and glottocodes
languages <- read_tsv("data/languages_map.tsv")
# replace glottocodes with full language names in the admixture file
rename <- function(dataset){
dataset %>%
left_join(languages, by = c("Language" = "glottocode")) %>%
select(Language = full_name_no_spaces, starts_with("Pop"), family)
}
# replace glottocodes with full language names in the admixture file and reshape
rename_gather <- function(dataset){
dataset %>%
left_join(languages, by = c("Language" = "glottocode")) %>%
select(Language = full_name_no_spaces, starts_with("Pop"), family) %>%
gather(variable, value, -Language, -family)
}
# calculate average Pop proportions per language family and find out,
# which population corresponds to each family
calculate_proportions <- function(dataset){
dataset %>%
group_by(family, variable) %>%
summarise(mean = round(mean(value), digits = 2)) %>%
pivot_wider(names_from = variable, values_from = mean)
}
# calculate admixture per family per level
calculate_admixture <- function(dataset){
dataset %>%
group_by(family, variable) %>%
summarise(mean = round(mean(value), digits = 2)) %>%
mutate(admixture = 1 - max(mean)) %>%
select(family, admixture) %>%
filter(duplicated(family) == FALSE)
}
# Attribute each Pop to family
pop_to_family <- function(dataset_rename_gather){
dataset_rename_gather %>%
group_by(family, variable) %>%
mutate(max_mean = max(mean(value))) %>%
select(-Language, -value) %>%
filter(duplicated(family) == FALSE) %>%
group_by(family) %>%
filter(max_mean == max(max_mean))
}
phonology_rename <- rename(phonology_K4)
morphology_rename <- rename(morphology_K4)
phonology_K4 <- read.csv("data/outfiles_cleaned/outfile_phonology_structure_K4_run41_f", sep="\t")
phonology_rename <- rename(phonology_K4)
View(morphology_rename)
# Calculate average proportions of each Pop per family across languages
phonology_proportions <- calculate_proportions(phonology_rename_gather)
morphology_proportions <- calculate_proportions(morphology_rename_gather)
#### Admixture ####
phonology_admixture <- calculate_admixture(phonology_rename_gather)
phonology_rename_gather <- rename_gather(phonology_K4)
morphology_rename_gather <- rename_gather(morphology_K4)
syntax_rename_gather <- rename_gather(syntax_K4)
#### Admixture ####
phonology_admixture <- calculate_admixture(phonology_rename_gather)
morphology_admixture <- calculate_admixture(morphology_rename_gather)
syntax_admixture <- calculate_admixture(syntax_rename_gather)
# Calculate average proportions of each Pop per family across languages
phonology_proportions <- calculate_proportions(phonology_rename_gather)
morphology_proportions <- calculate_proportions(morphology_rename_gather)
syntax_proportions <- calculate_proportions(syntax_rename_gather)
####  Calculate mean admixture per level ####
mean(phonology_admixture$admixture)
mean(morphology_admixture$admixture)
mean(syntax_admixture$admixture)
#### Calculate mean admixture per level ####
# Create a table with average admixture values per family per level
admixture <- phonology_admixture %>%
inner_join(morphology_admixture, by = "family") %>%
inner_join(syntax_admixture, by = "family")
names(admixture) <- c("family", "phonology", "morphology", "syntax") # rename columns
admixture <- as.data.frame(admixture) # convert tibble to data frame
rownames(admixture) <- admixture$family # save family names in row names
admixture <- admixture[,-1] # delete the column with family names
round(rowMeans(admixture), digits = 3) # calculate the mean admixture per family
pop_to_family(phonology_rename_gather)
pop_to_family(morphology_rename_gather)
pop_to_family(syntax_rename_gather)
names(phonology_rename) <- c("Language", "Mongolo-Koreanic", "Tungusic", "Japonic", "Turkic", "Family")
names(morphology_rename) <- c("Language", "Japono-Koreanic", "Turkic", "Tungusic", "Mongolic", "Family")
names(syntax_rename) <- c("Language", "Tungusic", "Japono-Koreanic", "Turkic", "Mongolic", "Family")
syntax_rename <- rename(syntax_K4)
syntax_rename_gather <- rename_gather(syntax_K4)
syntax_admixture <- calculate_admixture(syntax_rename_gather)
syntax_proportions <- calculate_proportions(syntax_rename_gather)
names(syntax_rename) <- c("Language", "Tungusic", "Japono-Koreanic", "Turkic", "Mongolic", "Family")
View(syntax_rename)
300*12
350*12
1950*12
20000-1300*12
100-64
100-68
